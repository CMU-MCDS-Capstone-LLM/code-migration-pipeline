# Code Migration Pipeline

## Components

- **coding-agent**: Git repository for generating code migrations
- **testing-agent**: Git repository for generating unit tests
- **evaluator**: Git repository for computing evaluation metrics on generated patches

## Data Folder Structure

The `data/` folder contains all the input and output of different stages for migration on a repo.

For a PyMigBench data point with repo "author/repo" and commit hash "12345678", the folder structure is as follows:

```
data/
├── envs/                    
│   └── author_repo__12345678/    # Docker environment and setup scripts
├── eval-tests/              
│   └── author_repo__12345678/    # Generated test cases for evaluation
├── input-tests/             
│   └── author_repo__12345678/    # Generated test cases for migration
├── repos/                   
│   └── author_repo__12345678/    # Cloned repository source code
├── score/                   
│   └── author_repo__12345678/    # Score of the migration patch
└── trajectories/            
    └── author_repo__12345678/    # Log and patch generated by coding agent
```

> Note: Difference between input-tests and eval-tests
> input tests
>
> - generated by testing agent, with repo, commit as input
> - visible to coding agent
> - used to facilitate migration path generation
>
> eval tests
>
> - generated by testing agent, with repo, commit, and **ground-truth patch** as input
> - visible to evaluator, **not to coding agent**
> - used to evaluate unit test pass rate of the generated migration patch
